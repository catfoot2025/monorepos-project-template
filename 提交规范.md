# 规范

## 网址

https://www.conventionalcommits.org/en/v1.0.0/#specification

## 格式

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

## Type (Required)

A short keyword describing the _purpose_ of the commit. Common types include:

|        Type         |                                                                                                                             Purpose                                                                                                                             |
| :-----------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|       `feat`        |                                                                                                            A new feature (user-facing or internal).                                                                                                             |
|        `fix`        |                                                                                                              A bug fix (user-facing or internal).                                                                                                               |
|       `docs`        |                                                                                                         Documentation changes (e.g., README, comments).                                                                                                         |
|       `style`       |                                                                                                    Code formatting, style, or syntax (no functional change).                                                                                                    |
|     `refactor`      |                                                                                             Code restructuring without changing behavior (e.g., simplifying logic).                                                                                             |
|       `test`        |                                                                                                                    Adding or updating tests.                                                                                                                    |
|       `chore`       |                                                                                                  Maintenance tasks (e.g., tooling, CI/CD, dependency updates).                                                                                                  |
|      `revert`       |                                                                                                 Reverting a previous commit (use `revert: <hash>` for clarity).                                                                                                 |
| **BREAKING CHANGE** | a commit that has a footer `BREAKING CHANGE:`, or appends a `!` after the type/scope, introduces a breaking API change (correlating with [`MAJOR`](http://semver.org/#summary) in Semantic Versioning). A BREAKING CHANGE can be part of commits of any _type_. |

## Scope (Optional)

A string describing the _scope_ of the change (e.g., a module, component, or feature area). Examples:

- `api`, `ui/button`, `utils/parser`, `database/schema`.

## Subject (Required)

A short, imperative summary of the change (50 characters max). Write in present tense, starting with a verb.

**Examples**:

- `Add user authentication flow` (good)
- `Fix null pointer exception in login form` (good)
- `Update docs` (bad: too vague)

## Body (Optional)

Detailed explanation of the change (if needed). Use full sentences, wrap lines at 72 characters, and answer:

- _Why_ was this change made?
- _How_ does it differ from previous behavior?

**Example**:

```markdown
The login form previously assumed a valid email format, leading to server errors.  
This change adds client-side validation using a regex pattern to catch invalid emails early.
```

## Footer (Optional)

Metadata or breaking changes. Use this section for:

- **Breaking Changes**: Indicate incompatible updates with `BREAKING CHANGE: <description>`.
- **Issue Tracking**: Link to related tickets (e.g., `Closes #123`, `Resolves #45`).

**Examples**:

```markdown
BREAKING CHANGE: The `login()` method now requires a `clientId` parameter (previously optional).
```

## Example Commit Messages

#### **Basic Feature**

```markdown
feat(ui/button): Add loading state animation

When a button triggers an async action, show a spinning icon to indicate progress.  
Fixes #234
```

#### **Bug Fix**

```markdown
fix(api/payment): Resolve Stripe API timeout error

The payment endpoint timed out after 30s due to unhandled retries.  
Increased timeout to 60s and added exponential backoff for retries.
```

#### **Documentation Update**

```markdown
docs(readme): Add setup instructions for Docker

Added step-by-step guide for running the app locally with Docker Compose.  
Closes #189
```

#### **Breaking Change**

```markdown
refactor(utils/logger): Remove deprecated `logLevel` option

The `logLevel` parameter is no longer supported; use `logger.configure()` instead.  
BREAKING CHANGE: Existing code relying on `logLevel` will need to migrate to the new API.
```

# 实现

## 网址

https://commitlint.js.org/reference/rules

## 概述

@commitlint/cli和@commitlint/config-conventional是conventionalcommits规范的实现。它能够验证用户提交的message信息，是否符合conventionalcommits规范。若提交信息不符合规则，`commitlint` 会返回**非零退出码**（表示验证失败）。通过配合git的hooks，可以实现对不合规范的信息的提交。

## 安装

```
pnpm add -D @commitlint/cli @commitlint/config-conventional
```

## 配置文件

在项目的根目录下，创建配置文件commitlint.config.mjs。或者在package.json中添加commitlint字段。

```js

```

### 规则格式

在导出的对象中，通过rules字段来定义规则。每个规则由都是一个key-value键值对。值的类型可以是一个普通数组，可以是一个返回普通数组的函数，也可以是一个返回普通数组的Promise对象。

```js
// 返回数组
export default {
  // ...
  rules: {
    "header-max-length": [0, "always", 72],
  },
  // ...
};
// 返回数组的函数
export default {
  // ...
  rules: {
    "header-max-length": () => [0, "always", 72],
  },
  // ...
};
// 返回数组类型的Promise
export default {
  // ...
  rules: {
    "header-max-length": async () => [0, "always", 72],
  },
  // ...
};
```

值的格式如下：

level:数组的第一个元素。`0` disables the rule. For `1` it will be considered a warning for `2` an error.

**Applicable** ：数组的第二个元素。always|never。应用或反转这条规则。

**Value**: value to use for this rule.适用于此规则的值。

### 规则

#### `type-enum`（类型枚举）

限制提交类型只能是预设的合法值（如 `feat`、`fix`、`docs` 等）。

```js
  rules: {
    'type-enum': [2, 'always', ['feat', 'fix', 'docs', 'style', 'refactor', 'test', 'chore', 'revert']]
  }
```

#### type-case（类型风格）

可选数值

```
[
	"lower-case", // default
	"upper-case", // UPPERCASE
    "camel-case", // camelCase
    "kebab-case", // kebab-case
    "pascal-case", // PascalCase
    "sentence-case", // Sentence case
    "snake-case", // snake_case
    "start-case", // Start Case
];
```

示例

```
  rules: {
	'type-case': [2, 'always', 'lower-case']
  }
```

#### **`scope-enum`（作用域枚举）**

限制作用域只能是预设的合法值（如 `api`、`ui`、`component` 等）。

默认值为空数组，表示任何值都能通过检验。通常情况下用户需要指定项目中的各个模块值。

```js
rules: {
  'scope-enum': [2, 'always', ['api', 'ui', 'component', 'test', 'docs']]
}
```

#### **`scope-case`（作用域大小写）**

作用域值的类型风格。默认值如下：

```js
;[
  'lower-case', // default
  'upper-case', // UPPERCASE
  'camel-case', // camelCase
  'kebab-case', // kebab-case
  'pascal-case', // PascalCase
  'sentence-case', // Sentence case
  'snake-case', // snake_case
  'start-case', // Start Case
]
```

#### **`scope-required`（作用域必填）**

强制提交信息必须包含作用域（除非明确允许空作用域）。默认为'scope-required': [2, 'always']。

```js
rules: {
  'scope-required': [2, 'always']  // 强制要求作用域
  // 或 'never'（允许无作用域）
}
```

#### **`subject-case`**（主题风格）

主题的类型风格。默认值如下：

```js
;[
  'lower-case', // default
  'upper-case', // UPPERCASE
  'camel-case', // camelCase
  'kebab-case', // kebab-case
  'pascal-case', // PascalCase
  'sentence-case', // Sentence case
  'snake-case', // snake_case
  'start-case', // Start Case
]
```

#### subject-empty（主题是否为空）

是否允许主题为空

```
rules: {
  'subject-empty': [2, 'never']  // 强制要求主题不为空
  // 或 'never'（允许无作用域）
}
```

#### subject-full-stop（主题是否以句号结尾）

```
rules: {
  'subject-full-stop': [2, 'never', '.']  // 不使用.作为主题结尾
}
```

#### subject-max-length 主题最大长度

默认为无限大。

#### subject-min-length 主题最小长度

默认为0

#### body-full-stop

正文是否以.结尾，默认为从不

```
rules: {
  'subject-full-stop': [2, 'never', '.']  // 不使用.作为主题结尾
}
```

#### body-leading-blank

body前面是否有空行

```
rules: {
  'body-leading-blank': [2, 'always']
}
```

#### body-empty

body是否为空

```
rules: {
  'body-empty': [2, 'never']
}
```

#### body-max-length

body的最大长度。默认为无限长

#### body-max-line-length

body最多有多少行。默认为无限多

#### body-min-length

body的最小字符数。默认为0.

#### body-case

body的文字风格。默认为lower-case

```
[
	"lower-case", // default
	"upper-case", // UPPERCASE
    "camel-case", // camelCase
    "kebab-case", // kebab-case
    "pascal-case", // PascalCase
    "sentence-case", // Sentence case
    "snake-case", // snake_case
    "start-case", // Start Case
];
```

#### footer-leading-blank

页脚的前面是否有空行。

```
rules: {
  'footer-leading-blank': [2, 'always']
}
```

#### footer-empty

页脚是否为空

```
rules: {
  'footer-empty': [2, 'never']
}
```

#### footer-max-length

页脚最大长度，默认为无限大

#### footer-max-line-length

页脚最多行数。默认为无限大

#### footer-min-length

页脚最小的长度。默认为0

#### header-case

头部的风格。默认为lower-case

#### header-full-stop

头部是否以.结尾。默认为从不

#### header-max-length

头部的最大长度。

#### header-min-length

头部的最小长度

### 提示

### 最佳实践
